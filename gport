#!/bin/bash

set -eu

usage () {
    echo "usage: $0 base onto"
    echo "  move commits \$base..HEAD onto \$onto"
    echo "  and check out \$onto"
    exit 1
}

if [ $# -ne 2 ]; then
	usage
fi

base="$1"
onto="$2"

randomname=tmp_`head -c 4 /dev/urandom|md5sum|printfield 1`

# detach ourselves so as to not destroy the current branch:
git checkout HEAD^{}

# do the rebase
git rebase --onto "$onto" "$base"

# give the result a name (well what was the point man) aha can be existing one?
git branch -f "$onto"
